#import "lib/lib.typ": *
#show: chapter-style.with(
  title: "特征值的应用",
  info: info,
)

= 递归
<递归>

== Fibonacci 数列
<Fibonacci-数列>

对 Fibonacci 数列，$0, 1, 1, 2, 3, 5, 8, 13, …,$，已知$F_(k + 2) = F_(k_1) + F_k$，但这不是$𝒖_(k + 1) = 𝑨 𝒖_k$的形式，且只要一个方程，而非方程组，同时这是一个二阶差分方程。

令$𝒖_k = mat(delim: "[", F_(k + 1); F_k)$，再追加一个方程组成方程组

$ cases(delim: "{", F_(k + 2) &= F_(k + 1) + F_k, F_(k + 1) &= F_(k + 1)) $

把方程组用矩阵表达

$
  mat(delim: "[", F_(k + 2); F_(k + 1)) =
  mat(delim: "[", 1, 1; 1, 0)
  mat(delim: "[", F_(k + 1); F_k)
$

于是得

$ 𝒖_(k + 1) = 𝑨 𝒖_k, space 𝑨 = mat(delim: "[", 1, 1; 1, 0) $

矩阵$𝑨$是对称阵，故其特征值将会是实数，且其特征向量将会互相正交。因为是二阶，可以直接利用迹与行列式，解方程组

$
  cases(delim: "{", λ_1 + λ_2 &= 1, λ_1⋅λ_2 &= -1)
$

在求解之前，先写出通解法并观察

$ |𝑨 - λ 𝑰| = mdet(1 - λ, 1; 1, - λ) = λ^2 - λ -1 = 0 $

与前面 Fibonacci 数列的递归式$F_(k + 2) - F_(k + 1) - F_k = 0$比较，发现这两个式子在项数与幂次上非常相近。用求根公式解特征值得

$
  cases(delim: "{", λ_1 = 1 / 2(1 + sqrt(5)) ≈ 1.618, λ_2 = 1 / 2(1 - sqrt(5)) ≈ - 0.618)
$

其中，$λ_1$被称为黄金比（golden ratio），$λ_2$被称为共轭黄金比（conjugate golden ratio），对应的特征向量为$mat(delim: "[", λ; 1)$，即$𝒙_1 = mat(delim: "[", λ_1; 1), 𝒙_2 = mat(delim: "[", λ_2; 1)$。计算初始项，$𝒖_0 = mat(delim: "[", F_1; F_0) = mat(delim: "[", 1; 0)$。将初始项用特征向量表示出来$mat(delim: "[", 1; 0) = c_1 x_1 + c_2 x_2$，计算系数得$c_1 = sqrt(5) / 5, c_2 = -sqrt(5) / 5$。

得到 2 个不同的特征值，两个对应的特征向量必线性无关，则该矩阵可以被对角化。套用公式，即$𝑨$的$k$次方表达式$𝑨^k = 𝑺 λ^k 𝑺^(-1)$，则有

$ 𝒖_99 = 𝑨 𝒖_98 = … = 𝑨^99 𝒖_0 = 𝑺 λ^99 𝑺^(-1) 𝑺 c = 𝑺 λ^99 c $

代入特征值、特征向量，得

$
  𝒖_99 = mat(delim: "[", F_100; F_99) &=
  mat(delim: "[", frac(1 + sqrt(5), 2), frac(1 - sqrt(5), 2); 1, 1)
  mat(delim: "[", (frac(1 + sqrt(5), 2))^99, 0; 0, (frac(1 - sqrt(5), 2))^99)
  mat(delim: "[", sqrt(5) / 5; - sqrt(5) / 5)\ &=
  mat(delim: "[", c_1 λ_1^100 + c_2 λ_2^100; c_1 λ_1^99 + c_2 λ_2^99)
$

最终结果为$F_100 = c_1 λ_1^100 + c_2 λ_2^100$。原式的通解为$𝒖_k = c_1 λ^k x_1 + c_2 λ^k x_2$。于是有

$ F_n = frac(φ^n - ψ^n, φ - ψ) $

这个数列的增长由特征值来控制，较大的一个特征值起着决定性作用。即

$
  F_100 = c_1(frac(1 + sqrt(5), 2))^100 + c_2(frac(1 - sqrt(5), 2))^100 ≈ c_1(frac(1 + sqrt(5), 2))^100
$

可以看出，这种问题与求解$𝑨 𝒙 = 𝒃$不同，这是一个动态的问题，$𝑨$的幂在不停的增长，而问题的关键就是这些特征值。

== 一阶差分方程
<一阶差分方程>

现求$𝒖_(k + 1) = 𝑨 𝒖_k$。

要解此方程，需要将$𝒖_0$展开为矩阵$𝑨$特征向量的线性组合，即

$
  𝒖_0 = vecrow(delim: "[", x_1 x_2 … x_n) mat(delim: "[", c_1; c_2; ⋮; c_n) = 𝑺 c
$

于是

$ 𝑨 𝒖_0 = ∑ c_i 𝑨 𝒙_i = ∑ c_i λ_i 𝒙_i $

继续化简

$
  𝑨 𝒖_0 = [x_1 x_2 … x_n]
  dmat(delim: "[", λ_1, λ_2, ⋱, λ_n)
  mat(delim: "[", c_1; c_2; ⋮; c_n) = 𝑺 λ c
$

用矩阵的方式同样可以得到该式：

$ 𝑨 𝒖_0 = 𝑺 𝜦 𝑺^(-1) 𝒖_0 = 𝑺 𝜦 𝑺^(-1) 𝑺 c = 𝑺 𝜦 c $

则若我们要求$𝑨^100 𝒖_0$，则只需要将$λ$变为$λ^100$，而系数$c$与特征向量$x$均不变。即

$ 𝑺 λ^100 c = ∑ c_i λ_i^100 𝒙_i $

= 矩阵指数方法
<矩阵指数方法>

== 指数矩阵
<指数矩阵>

#definition[
  若$𝑨$是一个$n$阶方阵，则指数矩阵$e^𝑨$由是由以下数列定义

  $ e^𝑨 = 𝑰 + 𝑨 + frac(𝑨^2, 2!) + … + frac(𝑨^n, n!) + … $

]

#theorem[
  若$𝑨$是一个$n$阶方阵，则初值问题的解为
  $ 𝒙^′ = 𝑨 𝒙, 𝒙(0) = 𝒙_0 $

  由$𝒙(t) = e^(𝑨 t) 𝒙_0$给出，且这个解是唯一的。
]

接之前的例子，需要证明$ 𝑺 e^(𝜦 t) 𝑺^(-1) = e^(𝑨 t) $

$
  e^(𝑨 t)
  &= 𝑰 + 𝑨 t + frac((𝑨 t)^2, 2) + frac((𝑨 t)^3, 6) + ⋯ + frac((𝑨 t)^n, n!) + ⋯ e^(𝑨 t) \
  &= 𝑺 𝑺^(-1) + 𝑺 𝜦 𝑺^(-1)t + frac(𝑺 Λ^2 𝑺^(-1), 2)t^2 + frac(𝑺 Λ^3 𝑺^(-1), 6)t^3+ ⋯ + frac(𝑺 Λ^n 𝑺^(-1), n!)t^n + ⋯ e^(𝑨 t) \
  &= 𝑺(𝑰 + 𝜦 t + frac(Λ^2 t^2, 2) + frac(Λ^3t^3, 3) + ⋯ + frac(Λ^n t^n, n) + ⋯)𝑺^(-1) e^(𝑨 t) \
  &= 𝑺 e^(𝜦 t) 𝑺^(-1)
$

需要注意的是，$e^(𝑨 t)$的 Taylor 级数展开是恒成立的，但我们推出的版本却需要矩阵可对角化这个前提条件。

最后，将$e^(𝑨 t)$变为对角阵，因为对角阵简单、没有耦合

$
  e^(𝜦 t) = dmat(delim: "[", e^(λ_1 t), e^(λ_2 t), ⋱, e^(λ_n t))
$

有了$u(t) = 𝑺 e^(𝜦 t) 𝑺^(-1)u(0)$，再来看矩阵的稳定性可知，所有特征值的实部均为负数时矩阵收敛，此时对角线上的指数收敛为$0$。若画出复平面，则要使微分方程存在稳定解，则特征值存在于复平面的左侧（即实部为负）；要使矩阵的幂收敛于$0$，则特征值存在于单位圆内部（即模小于$1$），这是幂稳定区域。

#tip[
  不难看出，指数矩阵是幂级数的推广。
]
对二阶情况，有$y^″ + b y^′ + k = 0$。模仿差分方程的情形，构造方程组

$ cases(delim: "{", y^″ &= -b y^′ - k y, y^′ &= y^′) $

写成矩阵形式

$
  mat(delim: "[", y^″; y^′) = mat(delim: "[", - b, - k; 1, 0) mat(delim: "[", y^′; y)
$

令

$ u^′ = mat(delim: "[", y^″; y^′), med u = mat(delim: "[", y^′; y) $

继续推广，对于$5$阶微分方程$y^((5)) + b y^″ + c y^‴ + d y^″ + e y^′ + f = 0$，则可写作

$
  mat(delim: "[", y^((5)); y^″; y^‴; y^″; y^′) =
  mat(
    delim: "[",
    -b, -c, -d, -e, -f;
    1, 0, 0, 0, 0;
    0, 1, 0, 0, 0;
    0, 0, 1, 0, 0;
    0, 0, 0, 1, 0
  )
  mat(delim: "[", y^″; y^‴; y^″; y^′; y)
$

这样就把一个五阶微分方程化为$5 × 5$一阶方程组了，然后就是求特征值、特征向量了步骤了。

== 广义矩阵指数
<广义矩阵指数>

#definition[
  假设$𝒙_1(t), 𝒙_2(t), …, 𝒙_n(t)$是$𝒙^′ = 𝑨 𝒙$的$n$个线性无关解。则$n$阶方阵

  $
    ϕ(t) = mat(
      delim: "[",
      \|, \|, med, \|;
      𝒙_1(t), 𝒙_2(t), …, 𝒙_n(t);
      \|, \|, med, \|
    )
  $

  将这些解向量作为其列向量，称为基本矩阵（fundamental matrix）。
]

#theorem[
  令$𝒖_1, 𝒖_2, …, 𝒖_n$为$n$阶方阵$𝑨$的$n$个线性无关的广义特征向量。对于每个$1 ⩽ q i ⩽ q n$，令$𝒙_i(t)$是由下式给出的$𝒙^′ = 𝑨 𝒙$的解

  $
    𝒙(t) = e^(λ t) [ 𝒖 + (𝑨 - λ 𝑰) 𝒖 t + (𝑨 - λ 𝑰)^2 𝒖 frac(t^2, 2!) + … + (𝑨 - λ 𝑰)^(r -1) 𝒖 frac(t^(r -1), (r -1))! ]
  $

]

代入$𝒖 = 𝒖_i$和相对于$𝒖_i$的广义特征向量的特征值$λ$和秩$r$，则

$ e^(𝑨 t) = ϕ(t) ϕ(0)^(-1) $

其中，$ϕ(t)$为基本矩阵。
